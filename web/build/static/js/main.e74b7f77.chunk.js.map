{"version":3,"sources":["components/const.js","components/VideoView.js","components/Info.js","components/video_table.js","components/App.js","reportWebVitals.js","index.js"],"names":["host","window","location","protocol","hostname","DATA_URL","VideoView","stream","Container","className","style","maxHeight","src","Item","name","value","width","Info","props","useState","params","setParams","options","onChangeOptions","a","fetch","resp","ok","json","f","useEffect","interval","setInterval","fetchFps","clearInterval","console","log","showType","FormControl","variant","sx","m","minWidth","InputLabel","id","Select","labelId","type","label","onChange","e","target","MenuItem","size","read_fps","toFixed","detect_fps","yolo_time","deep_sort_time","is_saving","VideoShower","show","url","onClose","Modal","onHide","Header","closeButton","Title","Body","controls","VideoTable","data","setData","video","setVideo","d","fetchData","Table","bordered","hover","map","index","time","moment","format","filename","Button","onClick","path","App","page","setPage","setOptions","Navbar","bg","Nav","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.e74b7f77.chunk.js","sourcesContent":["const host = window.location.protocol + \"//\" + window.location.hostname;\r\n\r\nexport const BASE_URL = host + ':5000'\r\nexport const VIDEO_PREFIX = ''\r\n// export const VIDEO_PREFIX = 'http://localhost:8001'\r\n// export const BASE_URL = 'http://localhost:5000'\r\nexport const DATA_URL = BASE_URL + '/api/'\r\n","import {Container} from \"react-bootstrap-v5\";\r\nimport React, {useEffect, useState} from \"react\";\r\nimport {DATA_URL} from \"./const\";\r\n\r\n\r\nexport function VideoView({stream}) {\r\n\r\n    return (\r\n        <Container className=\"d-flex\">\r\n            <img className=\"ms-auto me-auto w-100\" style={{maxHeight: 'calc(100vh - 70px)'}} src={stream}/>\r\n        </Container>\r\n    )\r\n}\r\n","import React, {useEffect, useState} from \"react\";\r\nimport {DATA_URL} from \"./const\";\r\nimport {FormControl, InputLabel, MenuItem, Select} from \"@material-ui/core\";\r\n\r\nfunction Item({name, value}) {\r\n    return (\r\n        <tr>\r\n            <td className=\"fw-bold\" style={{width: '200px'}}>{name}:</td>\r\n            <td className=\"text-end\">{value}</td>\r\n        </tr>\r\n    )\r\n}\r\n\r\nexport function Info(props) {\r\n    const [params, setParams] = useState();\r\n    let options = props.options\r\n    let onChangeOptions = props.onChangeOptions\r\n\r\n    async function fetchFps() {\r\n        let resp = await fetch(DATA_URL + \"params\")\r\n        if (resp.ok) {\r\n            let f = await resp.json()\r\n            setParams(f)\r\n        }\r\n    }\r\n\r\n    useEffect(() => {\r\n        const interval = setInterval(() => {\r\n            fetchFps()\r\n        }, 5000);\r\n        return () => clearInterval(interval);\r\n    }, [props]);\r\n\r\n    console.log('opt', options)\r\n\r\n    return (\r\n        <div className=\"w-auto me-2\">\r\n            <div className={\"border p-2\" + (props?.showType ? \"\" : \" d-none\")}>\r\n                <FormControl className=\"m-2 w-100\" variant=\"standard\" sx={{m: 1, minWidth: 120}}>\r\n                    <InputLabel id=\"type-label\">Тип</InputLabel>\r\n                    <Select\r\n                        labelId=\"type-label\"\r\n                        id=\"type-select\"\r\n                        value={options?.type}\r\n                        label=\"Тип\"\r\n                        variant=\"standard\"\r\n                        sx={{width: 400}}\r\n                        onChange={(e) => onChangeOptions?.({...options, type: e.target.value})}\r\n                    >\r\n                        <MenuItem value={\"raw\"}>raw</MenuItem>\r\n                        <MenuItem value={\"detected\"}>detected</MenuItem>\r\n                    </Select>\r\n                </FormControl>\r\n                <FormControl className=\"m-2 w-100\" variant=\"standard\" sx={{m: 1, minWidth: 120}}>\r\n\r\n                    <InputLabel id=\"size-label\">Размер</InputLabel>\r\n                    <Select\r\n                        labelId=\"size-label\"\r\n                        id=\"size-select\"\r\n                        value={options?.size}\r\n                        label=\"Размер\"\r\n                        variant=\"standard\"\r\n                        sx={{width: 400}}\r\n                        onChange={(e) => onChangeOptions?.({...options, size: e.target.value})}\r\n                    >\r\n                        <MenuItem value={\"720\"}>720p</MenuItem>\r\n                        <MenuItem value={\"540\"}>540p</MenuItem>\r\n                        <MenuItem value={\"480\"}>480p</MenuItem>\r\n                        <MenuItem value={\"360\"}>360p</MenuItem>\r\n                    </Select>\r\n                </FormControl>\r\n            </div>\r\n            <div className=\"border p-2\">\r\n                <table>\r\n                    <tbody>\r\n                    <Item name=\"read fps\" value={params?.read_fps?.toFixed?.(3)}/>\r\n                    <Item name=\"detect fps\" value={params?.detect_fps?.toFixed?.(3)}/>\r\n                    <Item name=\"yolo time\" value={params?.yolo_time?.toFixed?.(3)}/>\r\n                    <Item name=\"DeepSort time\" value={params?.deep_sort_time?.toFixed?.(3)}/>\r\n                    <Item name=\"Запись\" value={params?.is_saving === true ? \"on\" : \"off\"}/>\r\n                    </tbody>\r\n                </table>\r\n            </div>\r\n\r\n        </div>\r\n    )\r\n}\r\n","import React, {useEffect, useState} from \"react\";\r\nimport {Button, Container, Modal, Table} from \"react-bootstrap-v5\";\r\nimport moment from \"moment\";\r\nimport {BASE_URL, DATA_URL, VIDEO_PREFIX} from \"./const\";\r\n\r\nfunction VideoShower({show, url, onClose, name}) {\r\n    console.log(url)\r\n    return (\r\n        <Modal show={show} onHide={() => onClose?.()} size=\"xl\">\r\n            <Modal.Header closeButton>\r\n                <Modal.Title>{name}</Modal.Title>\r\n            </Modal.Header>\r\n            <Modal.Body>\r\n                <video className=\"ms-auto me-auto w-100\" style={{maxHeight: 'calc(100vh - 70px)'}} controls src={url}/>\r\n            </Modal.Body>\r\n        </Modal>\r\n    )\r\n}\r\n\r\nexport function VideoTable(props) {\r\n\r\n    const [data, setData] = useState()\r\n\r\n    const [video, setVideo] = useState({show: false, url: null})\r\n\r\n    async function fetchData() {\r\n        let resp = await fetch(DATA_URL + 'accidents')\r\n        if (!resp.ok) {\r\n            return\r\n        }\r\n        let d = await resp.json()\r\n        setData(d)\r\n    }\r\n\r\n    useEffect(() => {\r\n        fetchData()\r\n    }, [props])\r\n\r\n    return (\r\n        <Container>\r\n\r\n            <Table bordered hover>\r\n                <thead>\r\n                <tr className=\"fw-bold\">\r\n                    <td>Время</td>\r\n                    <td>Имя файла</td>\r\n                    <td>Действие</td>\r\n                </tr>\r\n                </thead>\r\n                <tbody>\r\n                {\r\n                    data?.map?.((value, index) => (\r\n                        <tr key={index}>\r\n                            <td className=\"fw-bolder\">{value.time != null ? moment(value.time * 1000).format(\"DD.MM.YYYY HH:mm:ss.SSS\") : \"\"}</td>\r\n                            <td>{value.filename}</td>\r\n                            <td>\r\n                                <Button onClick={() => setVideo({\r\n                                    show: true,\r\n                                    video: VIDEO_PREFIX + value?.path,\r\n                                    name: value?.filename\r\n                                })}>Смотреть</Button>\r\n                            </td>\r\n                        </tr>\r\n                    ))\r\n                }\r\n\r\n                </tbody>\r\n            </Table>\r\n            <VideoShower show={video?.show}\r\n                         name={video?.name}\r\n                         url={video?.video}\r\n                         onClose={() => {setVideo({show: false})}}\r\n            />\r\n        </Container>\r\n\r\n    )\r\n}\r\n\r\n","import \"bootstrap/dist/css/bootstrap.min.css\"\n// import 'bootstrap/scss/bootstrap.scss'\nimport {Nav, Navbar} from \"react-bootstrap-v5\";\nimport React, {useState} from \"react\";\nimport \"./styles.css\"\nimport {DATA_URL} from \"./const\";\nimport {VideoView} from \"./VideoView\";\nimport {Info} from \"./Info\"\nimport {VideoTable} from \"./video_table\";\n\nfunction App(props) {\n    const [page, setPage] = useState(1)\n    const [options, setOptions] = useState({size: '480', type: 'detected'})\n\n    return (\n        <div>\n            <Navbar bg=\"secondary\" variant=\"dark\" className=\"mb-1\">\n                <div onClick={() => setPage(0)} className=\"navbar-brand\"></div>\n                <Nav className=\"mr-auto\">\n                    <div onClick={() => setPage(1)} className=\"nav-link cursor-pointer\">Записи</div>\n                    <div onClick={() => setPage(0)} className=\"nav-link cursor-pointer\">Видео</div>\n                </Nav>\n            </Navbar>\n            <div className=\"d-flex mt-2\">\n                {\n                    page === 0\n                        ? <VideoView stream={DATA_URL + \"stream?type=\" + options?.type + \"&size=\" + options?.size}/>\n                        : <VideoTable/>\n                }\n                <Info showType={page === 0} options={options} onChangeOptions={d => setOptions(d)}/>\n            </div>\n\n        </div>\n    )\n}\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './components/App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}